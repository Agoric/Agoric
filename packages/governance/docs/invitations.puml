@startuml governance invitation linkages

class "Registrar\n(In a Vat)" as Registrar {
    Questions[]
    terms: committeeSize...
    addQuestion(ballotCounterInstall, question, details)
    questionNotifier()
    #getVoterInvitation()
    getOpenQuestions()
}

note "produces VoterInvitations.\nunaware of BallotCounters." as N1
Registrar .. N1

object BallotDetails {
    question
    positions
    maxChoices
    closingRule: {timer, deadline}
    registrar
}

class "BallotCounter\n(In a Vat)" as BallotCounter {
    Question
    quorumRule
    closingRule
    registrar
    --
    makeBallot()
    countVotes()
    submitVote()
    getDeadline()
    +getBallotTemplate()
    +getOutcome()
    +getStats()
}

note "unaware of voter registration." as N2
BallotCounter .. N2

class BallotTemplate {
    question
    maxChoices

    choose(position...)
}

BallotTemplate ..> BallotDetails

object Question {
    name
    positionA
    positionB
    ...
}

class "ElectionManager\n(in a Vat)" as ElectionManager {
    Registrar
    addQuestion()
}

class VoterFacet {
    castBallot(template)
}

object VoterInvitation {
    Registrar
    --
    getVoterFacet()
}

ElectionManager --|> Registrar

Registrar --> VoterInvitation
Registrar --|> BallotCounter
Registrar --|> VoterFacet
VoterInvitation -> VoterFacet
VoterFacet -> BallotTemplate
BallotCounter --|> BallotTemplate

BallotTemplate ..> Question

@enduml