{"version":3,"sources":["utils/fetch-websocket.js","utils/constants.js","store/types.js","store/actions.js","store/reducer.js","store/operations.js","contexts/Application.jsx","components/Header.jsx","components/Web3Status.jsx","components/Purses.jsx","components/Inbox.jsx","components/Wallet.jsx","pages/App.jsx","index.jsx"],"names":["doFetch","req","getResponse","a","msg","data","obj","JSON","parse","type","expectedResponse","resolve","socket","removeEventListener","isWebSocketActive","Error","websocket","p","Promise","res","send","stringify","addEventListener","createWebSocket","onConnect","onDisconnect","onMessage","WebSocket","url","URL","process","protocol","getWebsocketEndpoint","deactivateWebSocket","close","updatePurses","payload","updateInbox","reducer","state","active","activateConnection","deactivateConnection","connected","serverConnected","serverDisconnected","purses","inbox","id","declineOffer","cancelOffer","then","result","alert","outcome","acceptOffer","TypeError","ApplicationContext","createContext","useApplicationContext","useContext","useStyles","makeStyles","theme","appBar","position","title","flexGrow","icon","marginRight","spacing","Header","children","classes","AppBar","className","Toolbar","Typography","variant","color","noWrap","Link","target","href","divider","pulse","animation","opacity","Web3Status","dispatch","account","useEffect","Chip","label","avatar","Button","onClick","minWidth","Purses","Array","isArray","length","List","map","pursePetname","brandRegKey","issuerPetname","extent","ListItem","key","value","ListItemIcon","ListItemText","primary","secondary","margin","buttons","marginLeft","RedIconButton","withStyles","root","palette","getContrastText","red","backgroundColor","IconButton","YellowIconButton","yellow","GreenIconButton","green","RedChip","width","borderColor","GreenChip","pet","petname","Inbox","reverse","requestContext","date","origin","instanceRegKey","instancePetname","proposalTemplate","give","want","status","edge","Grid","container","direction","item","display","stamp","Date","isoStamp","getTime","getTimezoneOffset","match","toISOString","formatDateNow","Box","component","fontWeight","Object","entries","i","role","keys","ListItemSecondaryAction","size","aria-label","handleCancel","handleDecline","handleAccept","paper","marginTop","marginBottom","padding","breakpoints","up","down","aside","borderRightColor","borderRightStyle","borderRightWidth","Wallet","Paper","align","xs","md","layout","createMuiTheme","main","typography","useNextVariants","render","useReducer","messageHandler","message","websocketListeners","activateWebSocket","Provider","CssBaseline","document","getElementById"],"mappings":"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","file":"static/js/main.d734ffca.chunk.js","sourcesContent":["/* globals window, WebSocket */\n\n// todo: refactor this to a class\n\nimport { API_URL } from './constants';\n\n// === FETCH\n\nexport async function doFetch(req) {\n  if (!isWebSocketActive()) {\n    throw Error('Must activate web socket before calling doFetch');\n  }\n\n  const socket = websocket;\n  \n  let resolve;\n  const p = new Promise(res => {\n    resolve = res;\n  });\n  socket.send(JSON.stringify(req));\n  const expectedResponse = `${req.type}Response`;\n  function getResponse({ data: msg }) {\n    // console.log('got', msg);\n    const obj = JSON.parse(msg);\n    if (obj.type === expectedResponse) {\n      resolve(obj);\n      socket.removeEventListener('message', getResponse);\n    }\n  }\n  socket.addEventListener('message', getResponse);\n  return p;\n}\n\n// === WEB SOCKET\n\nlet websocket = null;\n\nfunction getWebsocketEndpoint() {\n  // TODO proxy websocket.\n  const url = new URL('/private/wallet', API_URL || window.origin);\n  url.protocol = 'ws';\n  return url;\n}\n\nfunction createWebSocket({ onConnect, onDisconnect, onMessage }) {\n  websocket = new WebSocket(getWebsocketEndpoint());\n  if (onConnect) {\n    websocket.addEventListener('open', () => onConnect());\n  }\n  if (onDisconnect) {\n    websocket.addEventListener('close', () => onDisconnect());\n  }\n  if (onMessage) {\n    websocket.addEventListener('message', ({ data }) => onMessage(data));\n  }\n}\n\nfunction closeWebSocket() {\n  websocket.close();\n  websocket = null;\n}\n\nfunction isWebSocketActive() {\n  return !!websocket;\n}\n\nexport function activateWebSocket(websocketListeners = {}) {\n  if (isWebSocketActive()) return;\n  createWebSocket(websocketListeners);\n}\n\nexport function deactivateWebSocket() {\n  if (!isWebSocketActive()) return;\n  closeWebSocket();\n}\n","export const API_URL = process.env.REACT_APP_API_URL;\n","export const ACTIVATE_CONNECTION = 'ACTIVATE_CONNECTION';\nexport const DEACTIVATE_CONNECTION = 'DEACTIVATE_CONNECTION';\n\nexport const SERVER_CONNECTED = 'SERVER_CONNECTED';\nexport const SERVER_DISCONNECTED = 'SERVER_DISCONNECTED';\n\nexport const UPDATE_PURSES = 'UPDATE_PURSES';\nexport const UPDATE_INBOX = 'UPDATE_INBOX';\n\nexport const REJECT_OFFER = 'REJECT_OFFER';\nexport const CONFIRM_OFFER = 'CONFIRM_OFFER';\nexport const CANCEL_OFFER = 'CANCEL_OFFER';\n","import {\n  ACTIVATE_CONNECTION,\n  DEACTIVATE_CONNECTION,\n  SERVER_CONNECTED,\n  SERVER_DISCONNECTED,\n  UPDATE_PURSES,\n  UPDATE_INBOX,\n  CANCEL_OFFER,\n  REJECT_OFFER,\n  CONFIRM_OFFER,\n} from './types';\n\nexport const activateConnection = () => ({\n  type: ACTIVATE_CONNECTION,\n});\n\nexport const deactivateConnection = () => ({\n  type: DEACTIVATE_CONNECTION,\n});\n\nexport const serverConnected = () => ({\n  type: SERVER_CONNECTED,\n});\n\nexport const serverDisconnected = () => ({\n  type: SERVER_DISCONNECTED,\n});\n\nexport const updatePurses = payload => ({\n  type: UPDATE_PURSES,\n  payload,\n});\nexport const updateInbox = payload => ({\n  type: UPDATE_INBOX,\n  payload,\n});\n\nexport const cancelOffer = payload => ({\n  type: CANCEL_OFFER,\n  payload,\n});\n\nexport const declineOffer = payload => ({\n  type: REJECT_OFFER,\n  payload,\n});\n\nexport const acceptOffer = payload => ({\n  type: CONFIRM_OFFER,\n  payload,\n});\n","import {\n  ACTIVATE_CONNECTION,\n  DEACTIVATE_CONNECTION,\n  SERVER_CONNECTED,\n  SERVER_DISCONNECTED,\n  UPDATE_PURSES,\n  UPDATE_INBOX,\n  REJECT_OFFER,\n  CANCEL_OFFER,\n  CONFIRM_OFFER,\n} from './types';\nimport {\n  activateConnection,\n  deactivateConnection,\n  serverConnected,\n  serverDisconnected,\n  updatePurses,\n  updateInbox,\n  declineOffer,\n  cancelOffer,\n  acceptOffer,\n} from './operations';\n\nexport function createDefaultState() {\n  return {\n    active: false,\n    connected: false,\n    account: null,\n    purses: null,\n    inbox: null,\n  };\n}\n\n/* eslint-disable complexity */\nexport const reducer = (state, { type, payload }) => {\n  switch (type) {\n    case ACTIVATE_CONNECTION:\n      return activateConnection(state);\n    case DEACTIVATE_CONNECTION:\n      return deactivateConnection(state);\n\n    case SERVER_CONNECTED:\n      return serverConnected(state);\n    case SERVER_DISCONNECTED:\n      return serverDisconnected(state);\n\n    case UPDATE_PURSES:\n      return updatePurses(state, payload);\n    case UPDATE_INBOX:\n      return updateInbox(state, payload);\n\n    case REJECT_OFFER:\n      return declineOffer(state, payload);\n    case CANCEL_OFFER:\n      return cancelOffer(state, payload);\n    case CONFIRM_OFFER:\n      return acceptOffer(state, payload);\n\n    default:\n      throw new TypeError(`Action not supported ${type}`);\n  }\n};\n/* eslint-enable complexity */\n","import { doFetch } from '../utils/fetch-websocket';\n\nexport function activateConnection(state) {\n  return { ...state, active: true };\n}\nexport function deactivateConnection(state) {\n  return { ...state, active: false };\n}\n\nexport function serverConnected(state) {\n  return { ...state, connected: true };\n}\nexport function serverDisconnected(state) {\n  return { ...state, connected: false };\n}\n\nexport function updatePurses(state, purses) {\n  return { ...state, purses };\n}\nexport function updateInbox(state, inbox) {\n  return { ...state, inbox };\n}\n\nexport function declineOffer(state, id) {\n  doFetch({\n    type: 'walletDeclineOffer',\n    data: id,\n  }); // todo toast\n\n  return state;\n}\nexport function acceptOffer(state, id) {\n  const resultP = doFetch({\n    type: 'walletAcceptOffer',\n    data: id,\n  }); // todo toast\n\n  resultP.then(result => alert(result.data.outcome));\n  return state;\n}\nexport function cancelOffer(state, id) {\n  doFetch({\n    type: 'walletCancelOffer',\n    data: id,\n  });\n  return state;\n}\n","import React, { createContext, useContext, useReducer, useEffect } from 'react';\n\nimport {\n  activateWebSocket,\n  deactivateWebSocket,\n  doFetch,\n} from '../utils/fetch-websocket';\nimport {\n  updatePurses,\n  updateInbox,\n  serverConnected,\n  serverDisconnected,\n  deactivateConnection,\n} from '../store/actions';\nimport { reducer, createDefaultState } from '../store/reducer';\n\nexport const ApplicationContext = createContext();\n\nexport function useApplicationContext() {\n  return useContext(ApplicationContext);\n}\n\n// eslint-disable-next-line react/prop-types\nexport default function Provider({ children }) {\n  const [state, dispatch] = useReducer(reducer, createDefaultState());\n  const { active } = state;\n\n  useEffect(() => {\n    function messageHandler(message) {\n      if (!message) return;\n      const { type, data } = message;\n      if (type === 'walletUpdatePurses') {\n        dispatch(updatePurses(JSON.parse(data)));\n      }\n      if (type === 'walletUpdateInbox') {\n        dispatch(updateInbox(JSON.parse(data)));\n      }\n    }\n\n    function walletGetPurses() {\n      return doFetch({ type: 'walletGetPurses' }).then(messageHandler);\n    }\n    function walletGetInbox() {\n      return doFetch({ type: 'walletGetInbox' }).then(messageHandler);\n    }\n\n    if (active) {\n      activateWebSocket({\n        onConnect() {\n          dispatch(serverConnected());\n          walletGetPurses();\n          walletGetInbox();\n        },\n        onDisconnect() {\n          dispatch(serverDisconnected());\n          dispatch(deactivateConnection());\n          dispatch(updatePurses(null));\n          dispatch(updateInbox(null));\n        },\n        onMessage(message) {\n          messageHandler(JSON.parse(message));\n        },\n      });\n    } else {\n      deactivateWebSocket();\n    }\n  }, [active]);\n\n  return (\n    <ApplicationContext.Provider value={{ state, dispatch }}>\n      {children}\n    </ApplicationContext.Provider>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { AppBar, Link, Toolbar, Typography } from '@material-ui/core';\nimport WalletIcon from '@material-ui/icons/AccountBalanceWallet';\n\nconst useStyles = makeStyles(theme => ({\n  appBar: {\n    position: 'relative',\n  },\n  title: {\n    flexGrow: 1,\n  },\n  icon: {\n    marginRight: theme.spacing(1),\n  },\n}));\n\n// eslint-disable-next-line react/prop-types\nexport default function Header({ children }) {\n  const classes = useStyles();\n\n  return (\n    <AppBar position=\"absolute\" className={classes.appBar}>\n      <Toolbar>\n        <WalletIcon className={classes.icon} />\n        <Typography\n          variant=\"h6\"\n          color=\"inherit\"\n          noWrap\n          className={classes.title}\n        >\n          <Link color=\"inherit\" target=\"_blank\" href=\"https://agoric.com\">Agoric Wallet</Link>\n        </Typography>\n        {children}\n      </Toolbar>\n    </AppBar>\n  );\n}\n","import React, { useEffect } from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Button, Chip } from '@material-ui/core';\nimport PersonIcon from '@material-ui/icons/Person';\n\nimport { useApplicationContext } from '../contexts/Application';\nimport { activateConnection, deactivateConnection } from '../store/actions';\n\nconst useStyles = makeStyles(theme => ({\n  divider: {\n    marginRight: theme.spacing(2),\n  },\n  pulse: {\n    animation: '$pulse 1.5s ease-in-out 0.5s infinite',\n  },\n  '@keyframes pulse': {\n    '0%': {\n      opacity: 1,\n    },\n    '50%': {\n      opacity: 0.4,\n    },\n    '100%': {\n      opacity: 1,\n    },\n  },\n}));\n\nexport default function Web3Status() {\n  const classes = useStyles();\n  const { state, dispatch } = useApplicationContext();\n  const { active, connected, account } = state;\n\n  // Automatically connect to the wallet.\n  useEffect(() => dispatch(activateConnection()), [dispatch]);\n\n  function handleConnect() {\n    dispatch(activateConnection());\n  }\n\n  function handleDisconnect() {\n    dispatch(deactivateConnection());\n  }\n\n  return (\n    <>\n      {connected && (\n        <Chip\n          className={classes.divider}\n          label={account || 'anonymous'}\n          avatar={<PersonIcon />}\n        />\n      )}\n      {active ? (\n        <Button variant=\"contained\" onClick={handleDisconnect}>\n          Disconnect\n        </Button>\n      ) : (\n        <Button variant=\"contained\" onClick={handleConnect} className={classes.pulse}>\n          Connect\n        </Button>\n      )}\n    </>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport {\n  List,\n  ListItemIcon,\n  ListItem,\n  ListItemText,\n  Typography,\n} from '@material-ui/core';\nimport PurseIcon from '@material-ui/icons/BusinessCenter';\n\nimport { useApplicationContext } from '../contexts/Application';\n\nconst useStyles = makeStyles(theme => ({\n  icon: {\n    minWidth: 24,\n    marginRight: theme.spacing(2),\n  },\n}));\n\nexport default function Purses() {\n  const classes = useStyles();\n  const { state } = useApplicationContext();\n  const { purses } = state;\n\n  return (\n    <>\n      <Typography variant=\"h6\">Purses</Typography>\n      {Array.isArray(purses) && purses.length > 0 ? (\n        <List>\n          {purses.map(({ pursePetname, brandRegKey, issuerPetname, extent }) => (\n            <ListItem key={pursePetname} value={pursePetname} divider>\n              <ListItemIcon className={classes.icon}>\n                <PurseIcon />\n              </ListItemIcon>\n              <ListItemText\n                primary={pursePetname}\n                secondary={<><b>{extent} {issuerPetname}</b> {brandRegKey ? <i>({brandRegKey})</i> : ''}</>}\n              />\n            </ListItem>\n          ))}\n        </List>\n      ) : (\n        <Typography color=\"inherit\">No purses.</Typography>\n      )}\n    </>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\nimport { green, red, yellow } from '@material-ui/core/colors';\nimport {\n  Box,\n  Chip,\n  Grid,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemSecondaryAction,\n  IconButton,\n  Typography,\n} from '@material-ui/core';\nimport SwapIcon from '@material-ui/icons/SwapHorizontalCircle';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport CheckIcon from '@material-ui/icons/Check';\n\nimport { useApplicationContext } from '../contexts/Application';\n\nimport { cancelOffer, declineOffer, acceptOffer } from '../store/actions';\n\nconst useStyles = makeStyles(theme => ({\n  icon: {\n    margin: theme.spacing(1),\n  },\n  buttons: {\n    '& button ~ button': {\n      marginLeft: theme.spacing(1),\n    },\n  },\n}));\n\nconst RedIconButton = withStyles(theme => ({\n  root: {\n    color: theme.palette.getContrastText(red[500]),\n    backgroundColor: red[500],\n    '&:hover': {\n      backgroundColor: red[700],\n    },\n  },\n}))(IconButton);\n\nconst YellowIconButton = withStyles(theme => ({\n  root: {\n    color: theme.palette.getContrastText(yellow[500]),\n    backgroundColor: yellow[500],\n    '&:hover': {\n      backgroundColor: yellow[700],\n    },\n  },\n}))(IconButton);\n\nconst GreenIconButton = withStyles(theme => ({\n  root: {\n    color: theme.palette.getContrastText(green[500]),\n    backgroundColor: green[500],\n    '&:hover': {\n      backgroundColor: green[700],\n    },\n  },\n}))(IconButton);\n\nconst RedChip = withStyles(theme => ({\n  root: {\n    width: theme.spacing(12),\n    color: red[800],\n    borderColor: red[800],\n  },\n}))(Chip);\n\nconst GreenChip = withStyles(theme => ({\n  root: {\n    width: theme.spacing(12),\n    color: green[800],\n    borderColor: green[800],\n  },\n}))(Chip);\n\nconst pet = petname => petname || '???';\n\nexport default function Inbox() {\n  const classes = useStyles();\n  const { state, dispatch } = useApplicationContext();\n  const { inbox } = state;\n\n  function formatDateNow(stamp) {\n    const date = new Date(stamp);\n    const isoStamp = date.getTime() - date.getTimezoneOffset() * 60 * 1000;\n    const isoDate = new Date(isoStamp);\n    const isoStr = isoDate.toISOString();\n    const match = isoStr.match(/^(.*)T(.*)\\..*/);\n    return <>{match[1]}&nbsp;{match[2]}</>;\n  }\n\n  function handleCancel(id) {\n    dispatch(cancelOffer(id));\n  }\n\n  function handleDecline(id) {\n    dispatch(declineOffer(id));\n  }\n\n  function handleAccept(id) {\n    dispatch(acceptOffer(id));\n  }\n\n//  const offer = {\n//    id: Date.now(),\n//    instanceRegKey: instanceId,\n//    contractIssuerIndexToRole: ['TokenA', 'TokenB', 'Liquidity'],\n//    instanceInviteHook: ['makeInvite'], // E(publicAPI).makeInvite()\n//    instanceAcceptedHook: undefined, // Could be E(publicAPI)...\n//    seatTriggerHook: ['swap'], // E(seat).swap()\n//\n//    proposalTemplate: {\n//     give: {\n//       'Token*': {\n//          pursePetname: inputPurse.pursePetname,\n//          extent: inputAmount,\n//        },\n//      },\n//      want: {\n//        'Token*': {\n//          pursePetname: outputPurse.pursePetname,\n//          extent: outputAmount,\n//        },\n//      },\n//      exit: { onDemand: null },\n//    },\n//  };\n\n  return (\n    <>\n\n      <Typography variant=\"h6\">Transactions</Typography>\n      {Array.isArray(inbox) && inbox.length > 0 ? (\n        <List>\n          {inbox.reverse().map(\n            ({\n              requestContext: { date, origin = 'unknown origin'} = {},\n              id,\n              instanceRegKey,\n              instancePetname,\n              proposalTemplate: { give = {}, want = {} } = {},\n              status,\n            }) => (\n              <ListItem key={id} value={date} divider>\n                <ListItemIcon>\n                  <SwapIcon edge=\"start\" className={classes.icon} />\n                </ListItemIcon>\n                <Grid container direction=\"column\">\n                  <Grid item>\n                    <Typography variant=\"body2\" display=\"block\" color=\"secondary\">\n                    At&nbsp;\n                    {date ? formatDateNow(date) : <i>unknown time</i>} via&nbsp;\n                    {origin}\n                    </Typography>\n                  </Grid>\n                  <Grid item>\n                    <Typography variant=\"body2\" display=\"block\" color=\"secondary\">\n                      <Box component=\"span\" fontWeight={800}>\n                        {pet(instancePetname)}\n                        &nbsp;\n                      </Box>\n                      {!instancePetname && <i>({instanceRegKey})&nbsp;</i>}\n                      says:\n                    </Typography>\n                  </Grid>\n                  <Grid item>\n                    {Object.entries(give).map(\n                      ([role, { issuerPetname, pursePetname, brandRegKey, extent }], i) => (\n                        <Typography key={`give${role}`} variant=\"body1\">\n                          {i === 0 ? 'Give' : <>and&nbsp;give</>}&nbsp;\n                          <Box component=\"span\" fontWeight={800}>\n                            {extent}\n                            &nbsp;\n                            {pet(issuerPetname)}\n                          </Box>\n                          {!issuerPetname && <>&nbsp;<i>({brandRegKey})</i></>} from&nbsp;\n                          <Box component=\"span\" fontWeight={800}>\n                            {pet(pursePetname)}\n                          </Box>\n                        </Typography>\n                      ))}\n                    {Object.entries(want).map(\n                      ([role, { issuerPetname, pursePetname, brandRegKey, extent }], i) => (\n                        <Typography key={`want${role}`} variant=\"body1\">\n                          {i === 0 ?\n                            (Object.keys(give).length > 0 ? <>to&nbsp;receive</> : 'Receive') :\n                            <>and&nbsp;receieve</>\n                          }&nbsp;\n                          <Box component=\"span\" fontWeight={800}>\n                            {extent}\n                            &nbsp;\n                            {pet(issuerPetname)}\n                          </Box>\n                          {!issuerPetname && <>&nbsp;<i>({brandRegKey})</i></>} into&nbsp;\n                          <Box component=\"span\" fontWeight={800}>\n                            {pet(pursePetname)}\n                          </Box>\n                        </Typography>\n                      ))}\n                  </Grid>\n                </Grid>\n                <ListItemSecondaryAction className={classes.buttons}>\n                  {status === 'decline' && (\n                    <RedChip variant=\"outlined\" label=\"Declined\" />\n                  )}\n                  {status === 'rejected' && (\n                    <RedChip variant=\"outlined\" label=\"Rejected\" />\n                  )}\n                  {status === 'accept' && (\n                    <GreenChip variant=\"outlined\" label=\"Accepted\" />\n                  )}\n                  {status === 'pending' && (\n                    <YellowIconButton\n                      size=\"small\"\n                      aria-label=\"Cancel\"\n                      onClick={() => handleCancel(id)}\n                    >\n                      <ClearIcon />\n                    </YellowIconButton>\n                  )}\n                  {status === 'cancel' && (\n                    <RedChip variant=\"outlined\" label=\"Cancelled\" />\n                  )}\n                  {!status && (\n                    <>\n                      <RedIconButton\n                        size=\"small\"\n                        aria-label=\"Decline\"\n                        onClick={() => handleDecline(id)}\n                      >\n                        <ClearIcon />\n                      </RedIconButton>\n                      <GreenIconButton\n                        size=\"small\"\n                        aria-label=\"Accept\"\n                        onClick={() => handleAccept(id)}\n                      >\n                        <CheckIcon />\n                      </GreenIconButton>\n                    </>\n                  )}\n                </ListItemSecondaryAction>\n              </ListItem>\n            ),\n          )}\n        </List>\n      ) : (\n        <Typography color=\"inherit\">No transactions.</Typography>\n      )}\n    </>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Grid, Paper, Typography } from '@material-ui/core';\n\nimport Purses from './Purses';\nimport Inbox from './Inbox';\n\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(3),\n    marginBottom: theme.spacing(3),\n    padding: theme.spacing(2),\n    [theme.breakpoints.up(600 + theme.spacing(3) * 2)]: {\n      marginTop: theme.spacing(6),\n      marginBottom: theme.spacing(6),\n      padding: theme.spacing(3),\n    },\n  },\n  title: {\n    padding: theme.spacing(0, 0, 4),\n    [theme.breakpoints.down('xs')]: {\n      display: 'none',      \n    },\n  },\n  aside: {\n    borderRightColor: theme.palette.divider,\n    borderRightStyle: 'solid',\n    borderRightWidth: 1,\n  },\n}));\n\nexport default function Wallet() {\n  const classes = useStyles();\n\n  return (\n    <Paper className={classes.paper}>\n      <Typography\n        component=\"h1\"\n        variant=\"h4\"\n        align=\"center\"\n        className={classes.title}\n      >\n        Simple Agoric Wallet\n      </Typography>\n\n      <Grid container spacing={2}>\n        <Grid item xs={12} md={4} className={classes.aside}>\n          <Purses />\n        </Grid>\n        <Grid item xs={12} md={8}>\n          <Inbox />\n        </Grid>\n      </Grid>\n    </Paper>\n  );\n}\n","import React from 'react';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { CssBaseline } from '@material-ui/core';\n\nimport Header from '../components/Header';\nimport Web3Status from '../components/Web3Status';\nimport Wallet from '../components/Wallet';\n\nconst useStyles = makeStyles(theme => ({\n  layout: {\n    width: 'auto',\n    marginLeft: theme.spacing(2),\n    marginRight: theme.spacing(2),\n    [theme.breakpoints.up(1000 + theme.spacing(2) * 2)]: {\n      width: 1000,\n      marginLeft: 'auto',\n      marginRight: 'auto',\n    },\n  },\n}));\n\nexport default function App() {\n  const classes = useStyles();\n\n  return (\n    <>\n      <CssBaseline />\n      <Header>\n        <Web3Status />\n      </Header>\n      <main className={classes.layout}>\n        <Wallet />\n      </main>\n    </>\n  );\n}\n","/* globals document */\nimport React from 'react';\nimport { render } from 'react-dom';\n\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles';\n\nimport ApplicationContextProvider from './contexts/Application';\nimport App from './pages/App';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#AB2328',\n    },\n    secondary: {\n      main: '#508AA8',\n    },\n  },\n  typography: {\n    useNextVariants: true,\n  },\n});\n\nrender(\n  <ApplicationContextProvider>\n    <MuiThemeProvider theme={theme}>\n      <App />\n    </MuiThemeProvider>\n  </ApplicationContextProvider>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}